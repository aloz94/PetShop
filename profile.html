<!DOCTYPE html>
<html lang="he">
<head>
  <meta charset="UTF-8">
  <title>פרופיל משתמש</title>

  <!-- Custom CSS -->
  <link rel="stylesheet" href="styles/profile.css">
  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Varela+Round&display=swap" rel="stylesheet">
  <!-- Tailwind for utility classes -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div class="profile-page container mx-auto p-4 font-['Varela_Round',sans-serif] text-gray-800">

    <!-- 1) Header -->
    <header class="profile-header text-center mb-8">
      <div class="profile-card inline-block bg-white rounded-lg shadow p-6">
        <img class="profile-avatar w-20 h-20 rounded-full mb-2 mx-auto"
             src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png"
             alt="avatar">
        <h2 id="username" class="text-xl font-semibold">ברוך הבא, עדן!</h2>
        <button class="logout-btn mt-2 px-4 py-1 bg-red-500 text-white rounded hover:bg-red-600"
                onclick="logout()">
          התנתקות
        </button>
      </div>
    </header>

    <!-- 2) Quick stats (3 cards) -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
  <!-- תור טיפוח הבא/נוכחי -->
  <div class="bg-white rounded-lg shadow">
    <div class="px-4 py-2 border-b font-semibold text-center">
      התור הבא לטיפוח
    </div>
    <div class="p-4" text-center>
      <p id="grooming-date">תאריך: –</p>
      <p id="grooming-time">שעה: –</p>
      <p id="grooming-service">שירות: –</p>
      <p id="grooming-dog">כלב: –</p>
      <p id="grooming-status">סטטוס: –</p>
          <div class="mt-4 flex justify-center gap-1">
      <button
        id="grooming-edit"
        class="mt-2 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 block mx-auto"
      >
        ערוך תור
      </button>

      <button id="grooming-cancel" class="mt-2 bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 block mx-auto"
              onclick="cancelGrooming()">
        בטל תור
      </button>
    </div>
  </div>
  </div>

  <!-- דיווחי נטושים -->
    <div class="bg-white rounded-lg shadow">
      <div class="px-4 py-2 border-b font-semibold text-center">
        דיווחי נטושים
      </div>
      <div class="p-4">
        <ul id="report-list" class="list-disc list-inside space-y-1">
          <!-- JS יוסיף כאן <li> לכל דיווח -->
        </ul>
        <p id="no-reports" class="text-gray-500">אין דיווחים</p>
      </div>
    </div>

    <!-- תור פנסיון הבא -->
    <div class="bg-white rounded-lg shadow">
      <div class="px-4 py-2 border-b font-semibold text-center">
        התור הבא לפנסיון
      </div>
      <div class="p-4" text-center>
        <p id="boarding-start">מתחיל: –</p>
        <p id="boarding-duration">למשך: – ימים</p>
        <p id="boarding-dog">כלב: –</p>
        <p id="boarding-status">סטטוס: –</p>
            <div class="mt-4 flex justify-center">
<button
                id="boarding-edit"
                class="mt-2 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 mx-auto"
                onclick="openPopup('EditBoarding_popup')">
              ערוך תור
            </button>
            <button id="boarding-cancel"  class="mt-2 bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600  mx-auto"
                onclick="cancelBoarding()">
          בטל תור
        </button>

      </div>
    </div>
  </div>

    
    <!-- 3) Personal Info & My Dogs -->
      <section class="details-dogs  ">
      <!-- Personal Info -->
      <div class="card bg-white rounded-lg shadow ">
        <h3 class="p-4 border-b font-semibold ">הפרטים האישיים שלי</h3>
        <ul class="info-list p-4 space-y-2">
          <li><strong>תעודת זהות:</strong> <span id="info-id"></span></li>
          <li><strong>שם:</strong> <span id="info-name"></span></li>
          <li><strong>מייל:</strong> <span id="info-email"></span></li>
          <li><strong>טלפון:</strong> <span id="info-phone"></span></li>
          <li><strong>כתובת:</strong> <span id="info-address"></span></li>
        </ul>
        <button class="edit-info-btn block mx-auto mb-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"
                onclick="openPopup('EditInfo_popup')">
          ערוך פרטים
        </button>
        <button class="pass-info-btn block mx-auto mb-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700"
                onclick="deleteUser()">
שינוי סיסמה        </button>
      </div>
</section>
      <!-- My Dogs -->
  <div class="card dogs ">
    <h3 class="text" style="text-align: center;">הכלבים שלי</h3>

    <div
      id="dog-list"
      class="dog-cards grid"
    >
      <!-- JS injects cards here -->
    </div>

    <button
      class="add-dog-btn "
      onclick="openPopup('AddDog_popup')"
    >
      + הוסף כלב
    </button>
  </div>


    <!-- 4) Future Appointments -->

  </div><!-- /.container -->
  <!-- ================= My Store Orders ================= -->
<section class="card bg-white rounded-lg shadow mb-8">
  <h3 class="p-4 border-b font-semibold text" style="text-align: center;">הזמנות החנות שלי</h3>
  <!-- השתלנו כאן לגריד 2 עמודות עם רווח אופקי -->
  <div class="p-4 grid grid-cols-1 md:grid-cols-2 gap-6">
    <!-- הזמנות בתהליך -->
    <div>
      <h4 class="font-semibold mb-2">הזמנות בתהליך</h4>
      <ul id="storeOrdersPending" class="list-disc list-inside text-gray-700">
        <!-- JS ימלא פה את הרשימה -->
      </ul>
      <p id="noPendingOrders" class="text-gray-500 hidden">אין הזמנות בתהליך</p>
    </div>
    <!-- הזמנות שהושלמו -->
    <div>
      <h4 class="font-semibold mb-2">הזמנות שהושלמו</h4>
      <ul id="storeOrdersCompleted" class="list-disc list-inside text-gray-700">
        <!-- JS ימלא פה את הרשימה -->
      </ul>
      <p id="noCompletedOrders" class="text-gray-500 hidden">אין הזמנות שהושלמו</p>
    </div>
  </div>
</section>

<div class="card-grid">
  <section class="history">
    <h3>היסטוריית תורים</h3>
    <div>
      <ul id="appointments-list">
        <!-- JS will inject future appointments here -->
      </ul>
    </div>
  </section>

  <section class="future">
    <h3>תורים עתידיים</h3>
    <ul id="Upcoming-appointments">
      <!-- JS will inject past appointments here -->
    </ul>
  </section>

  <section>
    <h3>כל דיווחי הנטושים שלי</h3>
    <div id="reports-list">
      <!-- JS will inject report cards here -->
    </div>
  </section>
</div>




  <!-- forms -->
  <!-- Add Dog Form -->
  <form id="AddDog_form">
    <div id="AddDog_popup" class="popup-container hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
      <div class="popup-content bg-white rounded-lg p-6 w-full max-w-md">
        <span class="close-btn float-right text-xl cursor-pointer" onclick="closeAddDogPopup(event)">&times;</span>
        <h2 class="text-lg font-semibold mb-4">פרטי הכלב</h2>
        <div class="input-group grid grid-cols-2 gap-4 mb-4">
          <input type="text" id="dogName" placeholder="שם הכלב *" required class="border rounded p-2">
  <select
    id="dogBreed"
    name="dogBreed"
    required
    class="border rounded p-2"
  >
    <option value="" disabled selected>בחר גזע *</option>
    <option value="לברדור">לברדור</option>
    <option value="רוטוילר">רוטוילר</option>
    <option value="פיקסיה">פיקסיה</option>
    <option value="גולדן רטריבר">גולדן רטריבר</option>
    <!-- הוסיפו פה עוד גזעים לפי הצורך -->
  </select>
        </div>
        <div class="input-group grid grid-cols-2 gap-4 mb-4">
          <input type="number" id="dogAge" placeholder="גיל *" min="0" required class="border rounded p-2">
          <select id="dogSize" required class="border rounded p-2">
            <option value="">בחר גודל *</option>
            <option>קטן</option>
            <option>בינוני</option>
            <option>גדול</option>
          </select>
        </div>
<div class="input-group mb-4 flex items-center">
          <label class="ml-4  whitespace-nowrap">מין* :</label>
          <div class="flex justify-center gap-6 w-full">
            <label class="inline-flex items-center">
              <input type="radio" name="dogGender" value="male" required class="mr-1"> זכר
            </label>
            <label class="inline-flex items-center">
              <input type="radio" name="dogGender" value="female" class="mr-1"> נקבה
            </label>
          </div>
        </div>
        <button type="submit"
                class="popup-button w-full bg-green-600 text-white py-2 rounded hover:bg-green-700">
          הוסף כלב
        </button>
      </div>
    </div>
  </form>

  <!-- Edit Dog Form -->
  <form id="EditDog_form">
    <div id="EditDog_popup" class="popup-container hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
      <div class="popup-content bg-white rounded-lg p-6 w-full max-w-md">
        <span class="close-btn float-right text-xl cursor-pointer" onclick="closePopup('EditDog_popup')">&times;</span>
        <h2 class="text-lg font-semibold mb-4">עריכת פרטי הכלב</h2>
        <input type="hidden" id="editDogId">
        <div class="input-group grid grid-cols-2 gap-4 mb-4">
          <input type="text" id="editDogName" placeholder="שם הכלב *" required class="border rounded p-2">
          <input type="text" id="editDogBreed" placeholder="גזע *" required class="border rounded p-2">  


        </div>
        <div class="input-group grid grid-cols-2 gap-4 mb-4">
          <input type="number" id="editDogAge" placeholder="גיל *" min="0" required class="border rounded p-2">
          <select id="editDogSize" required class="border rounded p-2">
            <option value="">בחר גודל *</option>
            <option value="קטן">קטן</option>
            <option value="בינוני">בינוני</option>
            <option value="גדול">גדול</option>
          </select>
        </div>
<div class="input-group mb-4 flex items-center">
          <label class="ml-4  whitespace-nowrap">מין *</label>
            <div class="flex justify-center gap-6 w-full">

          <label class="inline-flex items-center mr-4">
            <input type="radio" name="editDogGender" value="male" required class="mr-1"> זכר
          </label>
          <label class="inline-flex items-center">
            <input type="radio" name="editDogGender" value="female" class="mr-1"> נקבה
          </label>
        </div>
        </div>
        <button type="button"
                class="popup-button w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700"
                onclick="submitEditDog()">
          שמור שינויים
        </button>
      </div>
    </div>
  </form>

  <!-- Order Details Modal -->
<div id="orderDetailsModal" class="modal" aria-hidden="true">
  <div class="modal-content">
    <span class="modal-close" aria-label="Close">&times;</span>
    <div id="orderDetailsBody" class="modal-body">
      
      <!-- ===== 1) כותרת ראשית ===== -->
      <div class="order-header">
        <h2>הזמנה #${order.id}</h2>
        <div class="order-meta">
          נוצר ב: ${order.created_at} • סה״כ: ₪${order.total.toFixed(2)}
        </div>
      </div>

      <!-- ===== 2) פרטי לקוח ===== -->
      <div class="section">
        <h3>פרטי לקוח</h3>
        <p>${order.customer_name} — ${order.customer_phone} — ${order.customer_email}</p>
      </div>

      <!-- ===== 3) פרטי כתובת ===== -->
      <div class="section">
        <h3 >כתובת למשלוח</h3>
        <p>${order.street} ${order.house_number}, ${order.city}</p>
      </div>

      <!-- ===== 4) טבלת פריטי הזמנה ===== -->
      <table>
        <thead>
          <tr>
            <th>מוצר</th>
            <th>כמות</th>
            <th>יחידה</th>
            <th>סה״כ</th>
          </tr>
        </thead>
        <tbody>
          ${order.items.map(item => `
            <tr>
              <td>${item.product_name}</td>
              <td>${item.quantity}</td>
              <td>₪${item.unit_price.toFixed(2)}</td>
              <td>₪${item.line_total.toFixed(2)}</td>
            </tr>
          `).join('')}
        </tbody>
        <tfoot>
          <tr class="total-row">
            <td colspan="3"><strong>סה״כ הזמנה</strong></td>
            <td>₪${order.items.reduce((sum,i)=>sum+i.line_total,0).toFixed(2)}</td>
          </tr>
        </tfoot>
      </table>

    </div>
  </div>
</div>


  <!-- Main Script -->
  <script src="script/profile.js"></script>

</body>
</html>
